<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D-Tier APIs - Part 2</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>D-Tier APIs - Part 2</h1>
    <p>Experimental and rarely supported APIs.</p>
  </header>

  <main>
    <!-- Ambient Light Sensor API -->
    <section>
      <h2>üí° Ambient Light Sensor API</h2>
      <p id="lightLevel">Light level: Not supported</p>
      <script>
        if ('AmbientLightSensor' in window) {
          try {
            const sensor = new AmbientLightSensor();
            sensor.onreading = () => {
              document.getElementById("lightLevel").textContent =
                `Light: ${sensor.illuminance} lux`;
            };
            sensor.onerror = (e) => {
              document.getElementById("lightLevel").textContent =
                "Sensor error: " + e.error.name;
            };
            sensor.start();
          } catch (err) {
            document.getElementById("lightLevel").textContent = "Ambient Light API not allowed.";
          }
        }
      </script>
    </section>

    <!-- Proximity Sensor API -->
    <section>
      <h2>üì° Proximity Sensor API</h2>
      <p id="proximityInfo">Proximity: Not supported</p>
      <script>
        if ('ondeviceproximity' in window) {
          window.addEventListener("deviceproximity", (event) => {
            document.getElementById("proximityInfo").textContent =
              `Distance: ${event.value} cm`;
          });
        }
      </script>
    </section>

    <!-- Network Information Advanced -->
    <section>
      <h2>üåê Network Information API (Advanced)</h2>
      <p id="networkInfo"></p>
      <script>
        function updateNetworkInfo() {
          const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
          if (conn) {
            document.getElementById("networkInfo").textContent =
              `Type: ${conn.effectiveType}, Downlink: ${conn.downlink} Mb/s`;
          } else {
            document.getElementById("networkInfo").textContent = "Not supported";
          }
        }
        updateNetworkInfo();
      </script>
    </section>

    <!-- Media Session API -->
    <section>
      <h2>üéµ Media Session API</h2>
      <p>Controls media playback with OS controls.</p>
      <audio id="sampleAudio" controls src="https://www.w3schools.com/html/horse.mp3"></audio>
      <script>
        if ('mediaSession' in navigator) {
          const audio = document.getElementById("sampleAudio");
          navigator.mediaSession.metadata = new MediaMetadata({
            title: "Sample Song",
            artist: "Demo Artist",
            album: "Test Album",
            artwork: [{ src: "https://via.placeholder.com/96", sizes: "96x96", type: "image/png" }]
          });
          navigator.mediaSession.setActionHandler("play", () => audio.play());
          navigator.mediaSession.setActionHandler("pause", () => audio.pause());
        }
      </script>
    </section>

    <!-- Idle Detection API -->
    <section>
      <h2>‚è≥ Idle Detection API</h2>
      <p id="idleInfo">Idle detection: Not supported</p>
      <script>
        if ('IdleDetector' in window) {
          (async () => {
            try {
              const idleDetector = new IdleDetector();
              await idleDetector.start({ threshold: 60000 }); // 1 min
              idleDetector.onchange = () => {
                document.getElementById("idleInfo").textContent =
                  `User: ${idleDetector.userState}, Screen: ${idleDetector.screenState}`;
              };
            } catch (err) {
              document.getElementById("idleInfo").textContent = "Idle API blocked: " + err;
            }
          })();
        }
      </script>
    </section>

    <!-- Navigation -->
    <hr>
    <nav class="part-navigation">
      <a href="d-tier.html">‚¨Ö Back to Part 1</a>
      <a href="index.html">üè† Home</a>
    </nav>
  </main>

  <footer>
    <p>Made for Offline Learning | 2025</p>
  </footer>
</body>
</html>
